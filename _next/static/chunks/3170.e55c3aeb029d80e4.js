(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3170],{83170:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var r=a(57437),n=a(2265),s=a(77314),i=a(68728),o=a(27990),l=a(48421),c=a(46650),m=a(33775),u=a(41317),d=a(67386);function p(e){var t,a,n,s,i;let{activeLayer:o,hoverInfo:p,selectedMetric:v,selectedLocation:h}=e;if(!p&&!h)return null;let j=e=>e?e===m.Zn.offPlan||e===m.Zn.pending||e===m.Zn.notStarted?"Off-plan":e===m.Zn.existing?"Ready to Move":"":"",f=e=>null==e||isNaN(e)?null:v===m.WI.pricePerSqftP6m||v===m.WI.salesPriceMedianP6m||v===m.WI.serviceChargesSqft?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.W,{})," ",(0,u.AZ)(e,1)]}):v===m.WI.numberOfListings||v===m.WI.totalSalesP12m||v===m.WI.totalRentContractsP12m?e.toLocaleString():(0,u.XX)(e),x=()=>{switch(v){case m.WI.numberOfListings:return"Listings";case m.WI.serviceChargesSqft:return"Service Charges";case m.WI.priceChangeYoy:return"% Price Change";case m.WI.rentalYield:return"% Rental Yield";case m.WI.rentChangeYoy:return"% Rent Change";case m.WI.fmvSpread:return"% FMV Spread";case m.WI.salesPriceMedianP6m:return"Median Price";case m.WI.pricePerSqftP6m:return"Median Price per Sqft";case m.WI.totalRentContractsP12m:return"Rent Contracts";case m.WI.totalSalesP12m:return"Sales Transactions";default:return""}};return(0,r.jsxs)(r.Fragment,{children:[p&&("projects"===o||"areas"===o)&&(0,r.jsx)(l.GI,{longitude:null!==(a=p.longitude)&&void 0!==a?a:0,latitude:null!==(n=p.latitude)&&void 0!==n?n:0,anchor:"bottom",closeButton:!1,children:(0,r.jsxs)("div",{children:[p.areaName&&(0,r.jsxs)("div",{className:"fw-bold",children:[p.areaName,p.type===d.mQ.project&&p.developmentStatus&&(0,r.jsxs)("span",{className:"text-muted small",children:[" ",j(p.developmentStatus)]})]}),p.metricValue&&(0,r.jsxs)("div",{className:"text-center",children:[f(p.metricValue)," ",x()]})]})}),(null==h?void 0:h.type)===d.mQ.project&&(0,r.jsx)(l.GI,{longitude:h.longitudePropAi,latitude:h.latitudePropAi,anchor:"bottom",closeButton:!1,children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"fw-bold",children:[h.projectName,h.developmentStatus&&(0,r.jsxs)("span",{className:"text-muted small",children:[" ",j(h.developmentStatus)]})]}),void 0!==h[v]&&null!==h[v]&&!isNaN(h[v])&&(0,r.jsxs)("div",{className:"text-center",children:[f(h[v])," ",x()]})]})},"selected-popup-".concat(h.propAiLocationKey)),p&&"master-projects"===o&&(0,r.jsx)(l.GI,{longitude:null!==(s=p.longitude)&&void 0!==s?s:0,latitude:null!==(i=p.latitude)&&void 0!==i?i:0,anchor:"bottom",closeButton:!1,children:(0,r.jsx)("div",{children:p.masterProjectNames?(0,r.jsx)("div",{className:"fw-bold",children:p.type===d.mQ.microCommmunity&&(0,r.jsx)("span",{className:"text-muted small",children:(null===(t=p.masterProjectNames)||void 0===t?void 0:t.length)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"fw-bold text-center",children:["Communities ",(0,r.jsx)("br",{})]})," ",(0,r.jsx)("span",{className:"fw-normal",children:p.masterProjectNames.join(", ")})]}):"No communities"})}):(0,r.jsx)("div",{children:"No Communities Available"})})})]})}var v=a(33145);function h(e){let{location:t}=e;return t?(0,r.jsx)(l.Jx,{longitude:t.longitude,latitude:t.latitude,anchor:"bottom",className:"dynamic-location-marker",children:(0,r.jsx)(v.default,{src:"/images/location-pin.png",width:40,height:40,alt:"Location marker"})}):null}a(69689);var j=a(57815),f=a(89856),x=a(46496),g=a(42551);function y(e){let{activeLayer:t,setActiveLayer:a,onAreaClick:c,selectedMetric:m,areaLocationsData:u,projectLocationsData:v,communityDataWithMasterProjects:y,selectedLocation:N,isLayerButtonClicked:P,resolveColorForMetricAndValue:C,mapRef:I,mapStyle:M,layerZoom:S,lat:b,lng:L,locationType:w,selectedMasterProject:E}=e,[W,k]=(0,n.useState)(10),A=n.useRef(null),Q=(0,x.s)(),[Z,z]=(0,n.useState)(null),[q,R]=(0,n.useState)({areas:!0,masterProjects:!1,projects:!1}),[T,O]=(0,n.useState)(null),{values:X}=(0,s.u6)(),[Y,F]=(0,n.useState)([]),[G,D]=(0,n.useState)(null),[J,U]=(0,n.useState)(null),[V,_]=(0,n.useState)(!1),B=X.preferredLocations||[],{dubaiAreaData:H,communityTilesData:K,projectsData:$}=(0,j.x)({areaLocationsData:u,communityDataWithMasterProjects:y,projectLocationsData:v,selectedMetric:m,resolveColorForMetricAndValue:C}),{handleZoomChange:ee,onHover:et,handleOnAreaClick:ea,handleMarkerHover:er,handleMarkerClick:en,flyToLocation:es}=(0,f.q)({activeLayer:t,selectedMetric:m,onAreaClick:c,isLayerButtonClicked:P,setActiveLayer:a,setLayerVisibility:R,setHoverInfo:O,setHoveredMarker:D,setSelectedMicroCommunity:U,setIsMasterProjectSelected:_,setZoomLevel:k,isMasterProjectSelected:V,communityTilesData:K,selectedMicroCommunity:J});!function(e){let{containerRef:t,mapRef:a,preferredLocations:r,setNormalizedPreferredLocations:s,activeLayer:i,selectedLocation:o,layerZoom:l,lat:c,lng:m,locationType:u,setDynamicLocation:p,flyToLocation:v,setLayerVisibility:h,setIsMasterProjectSelected:j,setSelectedMicroCommunity:f,dynamicLocation:x}=e;(0,n.useEffect)(()=>{let e=()=>{t.current&&a.current&&(t.current.style.height="".concat(window.innerHeight,"px"),a.current.getMap().resize())};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[t,a]),(0,n.useEffect)(()=>{s(r.filter(e=>e.areaName||e.projectName||e.hexName2000m).map(e=>e.areaName&&e.type===d.mQ.area?e.areaName.trim().toUpperCase():e.projectName&&e.type===d.mQ.project?e.projectName.trim().toUpperCase():e.hexName2000m&&e.type===d.mQ.microCommmunity?e.hexName2000m.trim().toUpperCase():null).filter(e=>null!==e))},[r,s]),(0,n.useEffect)(()=>{void 0!==l&&a.current&&a.current.getMap().flyTo({zoom:l,duration:1e4})},[l,a]),(0,n.useEffect)(()=>{if(c&&m&&u){let e=parseFloat(c),t=parseFloat(m);t>=54.717697&&t<=55.804665&&e>=24.543457&&e<=25.512563&&p({latitude:e,longitude:t,locationType:u})}},[c,m,u,p]),(0,n.useEffect)(()=>{if(!a.current||!x)return;let e=setTimeout(()=>{var e;v(null===(e=a.current)||void 0===e?void 0:e.getMap(),{type:x.locationType,longitudePropAi:x.longitude,latitudePropAi:x.latitude})},1e3);return()=>clearTimeout(e)},[x,v,a]),(0,n.useEffect)(()=>{if(a.current&&o){let e=a.current.getMap();(o.type===d.mQ.project&&o.latitudePropAi&&o.longitudePropAi||o.type===d.mQ.area&&o.mapGeoCoordinates||o.type===d.mQ.microCommmunity||o.type===d.mQ.masterProject&&o.hexName2000m)&&v(e,o)}},[o,v,a]),(0,n.useEffect)(()=>{h({areas:"areas"===i,masterProjects:"master-projects"===i,projects:"projects"===i}),(null==o?void 0:o.type)!==d.mQ.microCommmunity&&f(null),"master-projects"!==i&&j(!1)},[i,o])}({containerRef:A,mapRef:I,preferredLocations:B,setNormalizedPreferredLocations:F,activeLayer:t,selectedLocation:N,layerZoom:S,lat:b,lng:L,locationType:w,setDynamicLocation:z,flyToLocation:es,setLayerVisibility:R,setSelectedMicroCommunity:U,setIsMasterProjectSelected:_,dynamicLocation:Z});let ei=(0,n.useCallback)(e=>{if(et(e),Z)return},[et,Z]);return(0,r.jsx)("div",{className:"map-container",ref:A,children:(0,r.jsxs)(l.ZP,{ref:I,style:{width:"100%",height:"100%"},mapboxAccessToken:"pk.eyJ1IjoidGhpc2lzY3JpcyIsImEiOiJjbTQ3Z2t3a2EwNDQxMmpxeGtjZmxsZmQ3In0.pKKnCLXdnlyUIqXCYE7yLA",mapStyle:"streets"===M?"mapbox://styles/mapbox/streets-v11":"satellite"===M?"mapbox://styles/mapbox/satellite-v9":"mapbox://styles/thisiscris/cm8oz3qdg006401qv2q099tn2",initialViewState:Z?void 0:g.NW,onZoom:e=>ee(e.viewState.zoom),onMouseMove:ei,onMouseLeave:()=>{O(null),D(null)},maxBounds:[[54.717697,24.543457],[55.804665,25.512563]],interactiveLayerIds:"areas"===t?[g.vX.AREA]:"master-projects"===t?[g.vX.MICRO_COMMUNITY]:"projects"===t?[g.vX.PROJECT]:[],onClick:ea,children:[(0,r.jsx)(l.Pv,{position:"bottom-left"}),(0,r.jsx)(i.Z,{activeLayer:t,layerVisibility:q,dubaiAreaData:H,communityTilesData:K,projectsData:$,selectedMetric:m,normalizedPreferredLocations:Y,selectedMicroCommunity:J,selectedLocation:N,hoverInfo:T,zoomLevel:W,isMobile:Q,dynamicLocation:Z,selectedMasterProject:E}),(0,r.jsx)(h,{location:Z}),(0,r.jsx)(o.Z,{activeLayer:t,projectsData:$,zoomLevel:W,isMobile:Q,selectedMetric:m,normalizedPreferredLocations:Y,selectedLocation:N,hoveredMarker:G,handleMarkerClick:en,handleMarkerHover:er,setHoveredMarker:D}),(0,r.jsx)(p,{activeLayer:t,hoverInfo:T,selectedMetric:m,selectedLocation:N})]})})}a(64982),a(56744)},56744:function(){}}]);